<!DOCTYPE HTML>

<html>
    
	<head>
		<title>Louguan Star's Blog</title>
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="baidu-site-verification" content="TXUGY4f1Fu" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="/js/jquery.min.js"></script>
		<script src="/js/jquery.scrollzer.min.js"></script>
		<script src="/js/jquery.scrolly.min.js"></script>
		<script src="/js/skel.min.js"></script>
		<script src="/js/skel-layers.min.js"></script>
		<script src="/js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="/css/skel.css" />
			<link rel="stylesheet" href="/css/style.css" />
			<link rel="stylesheet" href="/css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>

    <body>
        <div id="wrapper">
        <!-- Header -->
    <section id="header" class="skel-layers-fixed">
        <header>
            <span class="image avatar"><img src="/images/avatar.jpg" alt="" /></span>
            <h1 id="logo"><a href="/">Louguan Star</a></h1>
            <p>心之安处，便是吾乡...</p>
        </header>
        <nav id="nav">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/blog">Blog</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
        <footer>
            <ul class="icons">
                <!-- <li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li> -->
                <!-- <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li> -->
                <!-- <li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li> -->
                <li><a href="https://github.com/maozi07" class="icon fa-github"><span class="label">Github</span></a></li>
                <li><a href="#" class="icon fa-envelope"><span class="label">Email</span></a></li>
            </ul>
        </footer>
    </section>


            <!-- Main -->
            <div id="main">
                <section>
    <div class="container">
        <header class="major">
            <h2>一次根目录满找不到占用空间文件问题</h2>
                <p class="post-meta">Mar 6, 2017</p>
        </header>

        <section class="post-content">
            <h4 id="server98">某台server突然根目录占用空间98%，但找不到占用空间的文件</h4>

<h3 id="section">问题产生</h3>

<p>发现一台server根目录占用满，使用df -h命令查看，根目录确实占用已90%</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[root@localhost /]# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/sda1             190G  172G  8.0G  96% /
/dev/sdb1             2.7T  1.4T  1.2T  56% /hahaha

</code></pre>
</div>

<p>使用du命令查找/目录下大文件；使用<code class="highlighter-rouge">lsof | grep delete</code>没有发现已删除文件进程仍占用的
```
[root@localhost ~]# du -sh –exclude=hahaha /*
8.5M    /bin
6.5M    /boot
4.0K    /CmdTool.log
388K    /dev
126M    /etc
116M    /home
149M    /lib
35M     /lib64
16K     /lost+found
8.0K    /media
12K     /MegaSAS.log
8.0K    /misc
7.9G    /mnt
17M     /Nagios-Plugin
44M     /opt
0       /proc
356K    /root
40M     /sbin
8.0K    /selinux
8.0K    /srv
0       /sys
100K    /tftpboot
2.2M    /tmp
6.2G    /usr
1.2G    /var</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
### 解决问题
将/目录再次挂载到/mnt下查看，发现异常,然后进入/mnt/hahaha目录下删除文件
</code></pre>
</div>
<p>[root@localhost /]# mount -o bind / /mnt
[root@localhost /]# du -sh   /mnt/*
8.5M    /mnt/bin
8.0K    /mnt/boot
4.0K    /mnt/CmdTool.log
165G    /mnt/hahaha
…
6.2G    /mnt/usr
1.2G    /mnt/var</p>

<p>```</p>

<h3 id="section-1">总结</h3>
<p>在删除<code class="highlighter-rouge">/mnt/hahaha</code>目录下的异常文件时先检查下文件内容以及使用<code class="highlighter-rouge">lsof</code>确认下文件是否在被使用</p>

<p>最终问题产生的根源是由于挂载的不细心，由于服务器一些基本维护另有分工所以造成了发现问题有些难度（和问题的产生）</p>

        </section>

        <footer>
            
            <a href="/2017/01/18/CentOS%E5%AE%89%E8%A3%85vsftp.html" class="float-left">&larr; Previous</a> 
            
            <a href="/2017/03/17/HDSF%E4%B8%8Aget%E6%95%B0%E6%8D%AE%E5%90%8E%E6%96%87%E4%BB%B6%E5%A4%A710%E5%80%8D.html" class="float-right">Next &rarr;</a> 

        </footer>

        <div id="footer" class="copyright">
            <ul class="copyright">
                <li>本文系原创，转载请注明：转自<a target="_blank" href="http://www.louguanstar.com">LouguanStar's Blog</a>，作者：<a target="_blank" href="http://wwww.louguanstar.com/about/">LouguanStar</a></li>
                <li>除特别说明外，本文基于<a target="_blank" href="http://creativecommons.org/licenses/by-sa/3.0/cn/">知识共享署名-相同方式共享 3.0 中国大陆许可协议</a>发布，转载或其它引用请保留文本署名和文章链接。</li>
            </ul>
        </div>

    </div>

</section>


            </div>
            <!-- Footer -->
    <section id="footer">
        <div class="container">
            <ul class="copyright">
                <li>&copy;2016&nbsp;Louguan Star. &nbsp;All rights reserved.&nbsp;Powered by jekyll.</li>
            </ul>
        </div>
    </section>

		</div>
	</body>
</html>
